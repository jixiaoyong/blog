---
title: 数据结构_红黑树
date: 2018-12-23 17:25:36
---

# 前言

红黑树是一种特殊的二叉搜索树，查找，插入和删除的时间复杂度均为$O(log_2N)$。

红黑树必须满足以下条件：

1. 必须有颜色（黑/红）

2. 根节点颜色为黑
3. 若节点是红色，则子节点必须是黑色（反之则不然）
4. 到叶节点或空子节点的每一条边上的黑色节点数量必须相同（空子节点指本应该有叶节点却没有的节点，默认为黑色）

如果不满足可以通过以下方式修正：

* 改变节点颜色
* 旋转（左、右）

# 旋转

以某个支点旋转（右旋为例，旋转时注意更新各个节点的父节点）：

本质是将该`节点a`向下进一位插入到其`右节点b`原先的位置，将其`左节点c`向上进一位插入到该`节点a`原先的位置，并将`左节点c的右节点`赋值给该`节点a`。

步骤：

1. 将该`节点a`放到`右节点b`的位置，将该``左节点c`放到`节点a`原先的位置，依次类推

2. 特殊的，将该`点a的内侧孙子`（`a的左子节点c`的`右子节点d`）断开与其`父节点c`的连接，转而连接到`a`上，成为`a的左子节点`

如图，依次插入`6,34,23`，**以`34`为支点右旋**：

<img src="https://jixiaoyong.github.io/images/20181223175956.png" width='50%' height='50%'>

对获得的结果，由于<font color="#ff0000">23</font>，<font color="#ff0000">34</font>都是红色违反了`规则3`，将`34的父节点23`设置黑，`祖父节点6`设为红，**以`祖父节6`点为支点左旋**：

![最终结果](https://jixiaoyong.github.io/images/20181223180637.png)

# 插入

每次插入红色节点，能够避免规则4。

一般先以二叉搜索树的规则将数据插入表中，然后再对照规则检查是否需要调整红黑树。

红黑树插入情况分类如下：

1. 插入位置为根节点，将节点颜色更改为黑色
2. 插入位置的父节点为根节点或父节点颜色为黑色，直接插入
3. 父节点为红色。

只有父节点为红色这种情况需要进行修正，这时又可以细分为以下三种情况：

![表格来自 http://www.cnblogs.com/skywang12345/p/3245399.html#a1](https://jixiaoyong.github.io/images/20181223182532.jpg)



【注意】对于`Case 3`当祖父节点没有**左节点**无法右旋时的特殊处理：

需要对先对当前节点的父节点进行右旋，再以父节点作为**新插入的点N**，将N的父节点设置为黑色，祖父节点设置为红色，以祖父节点为支点左旋。

如依次插入如下值：

```
32,3,53,13,983,[137],237,83,483,43,183
```

当插入`137`后红黑树如图：

![插入137后的树](https://jixiaoyong.github.io/images/20181223210305.png)

本来按照`Case 3 父红 叔黑 是左节点 ` 应该要以祖节点右旋，但是组节点53没有左子节点，无法右旋，所以先对父节点983进行右旋：

![](https://jixiaoyong.github.io/images/20181223210800.png)

再以`983`为新节点，`父红 叔黑 是右节点`，将`父节点137`设置为黑色，`祖节点53`设置为红色，以`组节点53`为支点左旋：

![](https://jixiaoyong.github.io/images/20181223211217.png)



# 删除

删除比较复杂，可以有两种操作：

1. 在节点中保存一个标志位，标记该节点是否被删除，并不针真的删除该点。
2. 在执行删除操作时真正删除该点。

# 源码

[👉点这里](https://github.com/jixiaoyong/Notes-Files/blob/master/AndroidLearningResource/java_note/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AD%A6%E4%B9%A0/tree/RedBlackTree.kt)查看源码

# 参考文档

[在线操作红黑树](https://sandbox.runjs.cn/show/2nngvn8w)

[红黑树(一)之 原理和算法详细介绍](http://www.cnblogs.com/skywang12345/p/3245399.html#a1)